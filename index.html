<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Emergency Contacts â€” India</title>
<style>
  :root{--bg:#f7f7f7;--card:#fff;--accent:#0b5cff;--danger:#e23b3b;}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#111;background:var(--bg);display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px;}
  .card{background:var(--card);max-width:540px;width:100%;padding:15px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.08);}
  h1{margin:0 0 8px;font-size:22px;}
  p.lead{margin:0 0 18px;color:#444;}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
  .btn{display:flex;flex-direction:column;align-items:flex-start;padding:12px 14px;border-radius:10px;text-decoration:none;border:1px solid #eee;background:#fafafa;color:#111;}
  .btn strong{font-size:16px;}
  .btn small{color:#666;margin-top:6px;}
  .foot{margin-top:14px;font-size:13px;color:#666;}
  .big{grid-column:span 2;display:flex;justify-content:center;}
  .danger{background:#fff6f6;border-color:#ffd6d6;}
  .note{margin-top:12px;font-size:13px;color:#a33;}
  .actions{display:flex;gap:8px;margin-top:16px;}
  .bigbtn{flex:1;padding:14px;border:none;border-radius:10px;font-weight:600;font-size:16px;cursor:pointer;}
  .pick{background:#fafafa;border:1px solid #ccc;}
  .call{background:var(--accent);color:#fff;}
  input[type="tel"]{width:100%;padding:10px;border-radius:10px;border:1px solid #ddd;margin-top:10px;}
  .hint{font-size:12px;color:#777;margin-top:8px;}
</style>
</head>
<body>
  <div class="card">
    <h1>Emergency Contacts</h1>
    <p class="lead">Tap to call emergency services, or set your own quick dial contact below.</p>

    <div class="grid">
      <a class="btn" href="tel:100"><strong>Police â€” 100</strong><small>Immediate police assistance</small></a>
      <a class="btn" href="tel:101"><strong>Fire â€” 101</strong><small>Fire & rescue</small></a>
      <a class="btn" href="tel:102"><strong>Ambulance â€” 102</strong><small>Medical ambulance</small></a>
      <a class="btn" href="tel:112"><strong>All-in-one â€” 112</strong><small>Single emergency number (police/fire/ambulance)</small></a>
      <a class="btn" href="tel:181"><strong>Women Helpline â€” 181</strong><small>Support for women</small></a>
    </div>

    <hr style="margin:15px 0;border:none;border-top:1px solid #eee;">

    <h2 style="font-size:18px;margin-bottom:8px;">Your Personal Emergency Contact</h2>
    <!-- <div id="status" style="font-size:13px;color:#666;margin-bottom:10px;">Checking capabilities...</div> -->

    <div class="actions">
      <button id="pickContact" class="bigbtn pick">ðŸ“‡ Pick Contact</button>
    </div>

    <input id="manualInput" type="tel" placeholder="+91 98xxxxxxxx" style="display:none" />
    <button id="callNow" class="bigbtn call" style="display:none;margin-top:12px;">ðŸ“ž Call <span id="callLabel"></span></button>
    <div id="chosen" style="font-size:13px;margin-top:10px;color:#333;">No number chosen yet.</div>
    <div class="hint" id="hint" style="display:none"></div>

    <div class="foot">Your browser may ask for permission to access contacts. Calls still require manual confirmation.</div>
    <div class="note">Note: This tool cannot auto-dial without your consent.</div>
  </div>

  <script>
  (function(){
    const pickBtn = document.getElementById('pickContact');
    const manualBtn = document.getElementById('manualBtn');
    const manualInput = document.getElementById('manualInput');
    const callNow = document.getElementById('callNow');
    const callLabel = document.getElementById('callLabel');
    const chosen = document.getElementById('chosen');
    const status = document.getElementById('status');
    const hint = document.getElementById('hint');

    const STORAGE_KEY = 'emergency_speed_dial_number';
    const hasContactPicker = ('contacts' in navigator) && typeof navigator.contacts.select === 'function';

    //status.textContent = hasContactPicker ? 'Contact Picker API is available.' : 'Contact Picker not available â€” manual entry only.';
    hint.style.display = 'block';
    hint.textContent = hasContactPicker
      ? 'You can pick a saved contact from your device securely.'
      : 'Enter a phone number manually to save it locally.';

    function normalize(n){ return n ? n.replace(/[\s()\-]/g,'').trim() : ''; }

    function updateUI(num){
      if(num){
        chosen.innerHTML = 'Saved number: <strong>'+num+'</strong>';
        callLabel.textContent = num;
        callNow.style.display = 'block';
      } 
	  <!-- else { -->
        <!-- chosen.textContent = 'No number chosen yet.'; -->
        <!-- callNow.style.display = 'none'; -->
      <!-- } -->
    }

    const stored = localStorage.getItem(STORAGE_KEY);
    updateUI(stored);

    pickBtn.addEventListener('click', async ()=>{
      <!-- if(!hasContactPicker){ alert('Contact Picker not supported. Use manual entry.'); return; } -->
      try{
        const contacts = await navigator.contacts.select(['tel','name'], {multiple:false});
        if(contacts.length){
          const tel = Array.isArray(contacts[0].tel)?contacts[0].tel[0]:contacts[0].tel;
          const num = normalize(tel);
          if(num){
            localStorage.setItem(STORAGE_KEY,num);
            updateUI(num);
            alert('Saved '+num+' as emergency contact.');
          }
        }
      }catch(e){ console.error(e); alert('Failed to pick contact.'); }
    });

    manualBtn.addEventListener('click',()=>{
      manualInput.style.display = manualInput.style.display==='none'?'block':'none';
      manualInput.focus();
    });

    manualInput.addEventListener('keyup',(e)=>{
      if(e.key==='Enter'){
        const num=normalize(manualInput.value);
        if(num){
          localStorage.setItem(STORAGE_KEY,num);
          updateUI(num);
          manualInput.style.display='none';
          alert('Saved '+num+' as emergency contact.');
        }
      }
    });

    callNow.addEventListener('click',()=>{
      const num=localStorage.getItem(STORAGE_KEY);
      if(!num){ alert('No number saved.'); return; }
      if(confirm('Call '+num+'?')) window.location.href='tel:'+encodeURIComponent(num);
    });
  })();
  </script>
</body>
</html>
